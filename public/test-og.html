<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Open Graph Tester</title>
  <style>
    body {
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: #fafafa;
      padding: 40px 20px;
      margin: 0;
    }
    .container {
      max-width: 700px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    }
    h1 {
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      color: #111827;
      margin-top: 0;
    }
    h2 {
      font-family: 'Poppins', sans-serif;
      font-weight: 500;
      color: #374151;
      margin-top: 30px;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #E6E6E6;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    button {
      background-color: #6851FB;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-weight: 500;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #4A47A5;
    }
    pre {
      background-color: #f7f7f7;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      margin-top: 20px;
      white-space: pre-wrap;
    }
    .result {
      margin-top: 30px;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #E6E6E6;
    }
    .copy-btn {
      margin-left: 10px;
      padding: 4px 10px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Soundraiser Open Graph Tester</h1>
    <p>Use this tool to check how your smart links will render when shared on social platforms.</p>
    
    <h2>Test a Smart Link URL</h2>
    <div>
      <input type="text" id="url-input" placeholder="Enter your smart link URL (e.g., https://soundraiser.io/link/frank-ocean-lost)" 
             value="https://soundraiser.io/link/frank-ocean-lost">
      <button id="check-btn">Check OG Tags</button>
    </div>
    
    <div id="results" style="display: none;">
      <h2>Results</h2>
      <div id="result-content" class="result">
        <div id="og-preview"></div>
        <h3>Meta Tags Found</h3>
        <pre id="og-tags"></pre>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('check-btn').addEventListener('click', async () => {
      const url = document.getElementById('url-input').value.trim();
      if (!url) return;
      
      document.getElementById('results').style.display = 'block';
      document.getElementById('og-preview').innerHTML = '<p>Loading...</p>';
      document.getElementById('og-tags').textContent = 'Fetching...';
      
      try {
        // Use cors-anywhere or a similar proxy to fetch the page
        const corsProxy = 'https://corsproxy.io/?';
        const response = await fetch(corsProxy + encodeURIComponent(url));
        const html = await response.text();
        
        // Parse HTML to extract meta tags
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        
        // Find all Open Graph tags
        const metaTags = doc.querySelectorAll('meta[property^="og:"], meta[name^="twitter:"], meta[property^="music:"]');
        
        let tagsHtml = '';
        const ogData = {
          title: '',
          description: '',
          image: '',
          url: ''
        };
        
        metaTags.forEach(tag => {
          const property = tag.getAttribute('property') || tag.getAttribute('name');
          const content = tag.getAttribute('content');
          
          tagsHtml += `${property}: ${content}\n`;
          
          if (property === 'og:title') ogData.title = content;
          if (property === 'og:description') ogData.description = content;
          if (property === 'og:image') ogData.image = content;
          if (property === 'og:url') ogData.url = content;
        });
        
        document.getElementById('og-tags').textContent = tagsHtml || 'No Open Graph tags found';
        
        // Create a preview
        const previewHtml = `
          <div style="border: 1px solid #ddd; border-radius: 8px; overflow: hidden; max-width: 500px; margin-bottom: 20px;">
            ${ogData.image ? `<img src="${ogData.image}" style="width: 100%; height: auto; max-height: 250px; object-fit: cover;">` : ''}
            <div style="padding: 12px;">
              <div style="font-weight: bold; font-size: 16px; margin-bottom: 8px;">${ogData.title || 'No title found'}</div>
              <div style="font-size: 14px; color: #666; margin-bottom: 8px;">${ogData.description || 'No description found'}</div>
              <div style="font-size: 12px; color: #999;">${new URL(url).hostname}</div>
            </div>
          </div>
        `;
        
        document.getElementById('og-preview').innerHTML = previewHtml;
        
      } catch (error) {
        console.error('Error fetching URL:', error);
        document.getElementById('og-preview').innerHTML = `<p>Error: ${error.message}</p>`;
        document.getElementById('og-tags').textContent = 'Failed to fetch Open Graph tags';
      }
    });
  </script>
</body>
</html> 